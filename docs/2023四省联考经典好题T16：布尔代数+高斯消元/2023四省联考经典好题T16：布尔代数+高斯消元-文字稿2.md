本期视频会讲看待这个问题的两个视角
一个是把它看成图论的最短路问题
另一个是把它看成布尔代数的问题
这两个视角都带有很浓的算法竞赛味道
但我相信，经过我的讲解
完全没有算法竞赛背景的同学也能轻松理解！
我们会先讲更容易理解的图论模型
理解图论模型，会对理解后面讲的布尔代数模型有很大帮助
因此希望没有算法竞赛背景的同学能够耐心把两个视角都看完

打过算法竞赛的同学，应该会觉得这题很是亲切~
因为相比于发现正解
发现这是一个图论的最短路问题要容易得多
图论是啥，最短路又是啥？
没听说过也没关系，我讲完大家肯定都会懂~
首先，我们对9个格子的位置进行编码
为什么这里从0开始编号呢？
因为这样可以很方便地套公式把坐标转化为位置编号
以2逗1为例，它对应的编号是2乘3加1=7，这里3是列的数量
我们希望把开关阵列的所有可能状态都一一映射到某个数字
方便后续处理
所以接下来要引入一个叫状态压缩的东西
没有学过算法竞赛的同学不要被这个名词吓到了
它其实相当容易理解
格子有9个，我们就引入一个9位二进制数来表示开关阵列的一个状态
约定某个二进制位为1，表示这个位置的开关打开，0表示关闭

举个栗子，二进制数101010110
从右往左数的第1、2、4、6、8位是1，其他位是0
表示位置0逗0、1逗0、1逗2、2逗1的开关关闭
0逗1、0逗2、1逗1、2逗0、2逗2的开关打开
于是我们知道，开关阵列有2的9次方=512个状态
而对于任何一个状态，选择一个位置按开关
就前往另一个相邻的状态
有9个位置可选，我们就说
当前状态走一步，可以到达9个相邻的状态
比如，对于状态000000001
在0号位置按一次开关，就前往状态000001010
理解前面提到的模型后
我们就能正式引入图论模型来描述这道题了
记每个状态为一个点，选择一个位置按开关
就在当前状态和邻居状态之间连一条无向边
求从起始状态到目标状态按开关的最少次数
相当于求从起点到终点的最短路

经过上面的讲解，可能有同学还是对最短路模型云里雾里的
没关系，百闻不如一见，接下来我们直接写代码
可视化刚刚说的图论模型，帮助同学们理解
因为原问题的状态数比较多
所以这里我改成展示2乘2开关阵列的图论模型
目标状态约定为只有位置1逗1的开关打开
这样，节点数就只有2的4次方=16个

一开始，LLM生成的代码是用一个叫networkx的包实现的
但我感觉可视化结果不太美观
所以我希望节点能够拖动，拖到一个最短路最明显的状态
于是我了解到这个叫pyvis的包
我发现，pyvis会生成一个可交互的HTML文件
而且pyvis生成的网页每次刷新都能得到不同形态的图
只需要多刷新几次，就能看到具有对称性的图形态了
我们看到，从起点状态0到终点状态1000的一条最短路径是
0000、1011、0101、1000，按开关顺序是1、3、2
pyvis可视化效果演示视频里还展示了另一条最短路径3、1、2
我们发现，先按1再按3，和先按3再按1，到达的都是状态0101

拿到这样的题目，最需要的是展开想象力
多动手尝试，大胆探索题目具有的性质
首先，我们不难发现性质1
连续按某个位置奇数次，和按某个位置1次的效果完全一样
连续按某个位置偶数次，相当于没按过按钮
性质1意味着什么呢？
我们举些栗子
1，依次按位置1,1,4,5,1,4，可以简化为按4,5,1,4
因为连续按位置1两次相当于没按过
2，依次按位置4,5,1,1,1,4，可以简化为按4,5,1,4
因为连续按位置1三次相当于按位置1一次
位置4虽然总共按了两次，但不是连续按的
所以仅依靠性质1，不能消除按位置4的效果

性质2，对于当前的开关阵列S，先按位置x再按y
和先按位置y再按位置x的效果一样
换句话说，按开关的顺序是无关紧要的

我们已经拿到了方程组，最后一步就是把它解出来
但如果是在高考考场上，我们会用高斯消元法来算吗？
不现实的，没那么多时间、精力！
因为每个变量都只能是0和1
我们不妨用做小学逻辑题的技巧来推理出每个变量的值
反复应用布尔环的几条运算规则就行！
如果你已经懂这种方程怎么解，可以跳过这段推导过程
如果还不懂，强烈建议看完我的推导过程后
自己动手在纸上推一遍
动手完整算出一两次后，就知道布尔环怎么玩了！
方程2减方程3：a0+a4=a5，方程8减方程9：a4+a6=a5
两式左右相减得a0=a6
那就代入a0、a6都出现的方程4：a3+a4=0，即a3=a4
那就代入a3、a4都出现的方程5：a1+a5+a7=0，记为方程10
方程10减方程3：a2=a7
这里似乎卡住了，没关系
方程7减方程8：a3=a4+a8，结合刚刚的a3=a4得a8=0
代入方程9得a5+a7=0，所以a2=a5=a7，记为等式11
等式11代入方程3：a1=0
等式11代入方程6：a4+a8=0，前面已经求出a8，所以a4=0
于是a3、a4、a1、a8都是0，记为等式12
等式12代入方程1得a0、a6都是1
a0=1代入方程2得a2、a7、a5都是1
至此每个变量都解出来了，位置1、3、4、8为0，其他5个为1

这题的答案是唯一的，展示在屏幕的表格里了
最少按5次，其中一个最优操作序列是依次按下位置0、3、5、6、7

前面说了在考场上怎么算这个方程组，那怎么写代码求解呢？
直接用屏幕里展示的提示词就行
第一条提示词是随手写的，发现大语言模型默认去遍历整个解空间
所以我写了第二条提示词，让它用高斯消元法来算
现在还没有现成工具能直接算模2的线性方程组
所以它是直接手打高斯消元法实现的
计算结果一次正确，所以我们没必要看代码实现细节了
