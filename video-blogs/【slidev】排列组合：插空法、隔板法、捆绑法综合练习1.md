---
theme: dracula
mdc: true
transition: slide-left
class: text-center
tags:
  - 隔板法
  - 插空法
  - 捆绑法
---

<SlidevPageRedirector />
<AutoSlide :timeList="[50, 73, 57, 36, 13, 40, 22, 38, 30, 25, 30, 35, 53]" />

## 排列组合：插空法、隔板法、捆绑法综合练习1（一题多解、量大管饱）

题源： https://www.bilibili.com/video/BV1TAW3zWEWV

作者： **hans7**

**我们必须想象，做题人是幸福的**

文字稿传送门：见视频简介

---

## 插空法、捆绑法简介

个人认为（**结构主义**视角）：

1. 先单独学排列组合的各个方法，再联立起来一起练
2. 在用**多种方法**分析题目的过程中才能得到真正有价值的经验

所以采取 先看简介 → 用多种方法解题 → 重新回来看简介 的方法学习效果更好。

- 捆绑法：若干个东西必须相邻，我们就可以把它们绑起来，看成一个元素。最后记得乘上内部的方案数
- 插空法：出现“不相邻”就可以考虑。**插空顺序可自选**，但是不同顺序的分析难度可能有差别。这个可以在题目中慢慢体会

---

## 隔板法简介

用于解决一类套路题。把n个**相同的X**（比如球）分给m个**不同的Y**（比如人），则可以视为有m-1个隔板隔开。用数学语言描述，即求下面方程解的个数：

$$
\sum_{i=1}^{m} x_{i} = n,\ x_{i} \in N
$$

对于这种最简单的情况，我们想象有m-1个**相同的隔板**隔开这n个X，且隔板之间可以相邻，这就相当于在 $n+m-1$ 个**相同空位**中选择m-1个作为隔板，所以方案数是 $C_{n+m-1}^{m-1}$

如果 $x_{i}$ 只有下界限制，比如最常见的每个 $x_{i} \geq 1$ ，那么只需要把下界减掉就能转化为上面的情况。但对于每个 $x_{i} \geq 1$ 的特殊情况，我们还有第二种理解方式：n个X形成n+1个相同空位，但要去掉两端的空位，所以是在n-1个空位中选m-1个作为隔板，方案数 $C_{n-1}^{m-1}$

---

## 隔板法例题及扩展讨论

例：6个人参加游戏，获得10张复活卡，现进行分配，每人至少一张，求方案数

卡相同，作为X，人不同，作为Y。套公式 $C_{10-1}^{6-1} = C_{9}^5 = C_{9}^4 = 126$

### 扩展讨论

如果 $x_{i}$ 有上界限制，那么就需要对这些 $x_{i}$ 进行容斥原理了。相关讨论参见机械工业出版社的黑砖《组合数学》，这里空太小，先不展开。

这种模板题还衍生出另一种模板题，即把上一页方程的等于号改成≤，求方案数。关于这类问题的讨论可以先看我[这篇21年写的博客](https://blog.csdn.net/hans774882968/article/details/121804696)，以后有时间我会重新整理，并做一期视频。

---

## T1：某地组织9名委员负责调研小学教学情况，调研结束合影前有3名委员离开，学校决定安排3名小学生代表与委员一起坐在前排。要求每位小学生两边都坐着委员，求方案数

委员的排列方案数是 $A_{6}^6 = 720$ ，而小学生两两互斥，可以理解为小学生插委员形成的空位，两端不能选，所以方案数是在5个空位中选3个进行排列， $A_{5}^3 = 60$ 。总方案数 $720*60 = 43200$

---

## T2：有A~F六人站成一排，其中A、B相邻，C、D不能相邻，求方案数

A、B相邻，绑起来，最后记得乘 $2!$ 就行。C、D不能相邻，我们考虑**插空法**。这里的插空至少有两种做法。

### 法1：最后插D

先排其他3个和C，方案数 $A_{4}^4$ 。最后插入D。D有5个空可选，但无论C在什么位置，都有2个空不能选，所以D有3种插入方案。总方案数 $2! * A_{4}^4 * (5-2) = 144$

### 法2：C和D一起考虑

先排其他3个，方案数 $A_{3}^3$ 。此时它们形成了4个空位。C和D不能相邻，所以需要在4个空位中选2个，方案数 $C_{4}^2$ 。总方案数 $2! * A_{3}^3 * C_{4}^2 = 144$

### 法3：正难则反

也可以先求无限制的方案数 $v_{1}$ ，然后减去C、D相邻的方案数 $v_{2}$ 。 $v_{1} = 5! * 2! = 240$ ， $v_{2} = 4! * 2! * 2! = 96$ ，所以 $v_{1} - v_{2} = 144$

---

## T3：12棵同样松树和6棵同样柏树种在道路两侧，每侧9棵，每侧柏树数量相同且不相邻，道路起点、终点两侧都必须种松树。求方案数

注意到两侧松柏数量一样且完全独立，所以我们求出一侧的方案数是x，答案就是 $x^2$ 。减去4棵松树，还剩8棵，故只需要考虑一侧松柏数量分别为4、3。

由插空法，要求柏树不相邻，就相当于在4棵松树的5个空里选3个空插入柏树，方案数 $x = C_{5}^3 = 10$ 。答案 $x^2 = 100$

---

## T4：有 A~E 5人排成一排，求A与B相邻且A不与C相邻的方案数

题源： https://www.bilibili.com/video/BV1kM4m117pY

文字稿： https://hans774882968.github.io/teaching-plan-analytic-geometry/blog/%E6%9C%89A~E5%E4%BA%BA%E6%8E%92%E6%88%90%E4%B8%80%E6%8E%92%EF%BC%8C%E6%B1%82A%E4%B8%8EB%E7%9B%B8%E9%82%BB%E4%B8%94A%E4%B8%8D%E4%B8%8EC%E7%9B%B8%E9%82%BB%E7%9A%84%E6%96%B9%E6%A1%88%E6%95%B0

### 法1：正难则反

只需要满足A与B相邻：捆绑AB得 $A_{2}^2*A_{4}^4=48$ 。A与B、C都相邻，则A必须在中间，于是小团体的方案数是 $A_{2}^2$ ，ABC绑起来和D、E排序总方案数 $A_{2}^2A_{3}^3=12$ 。答案为 $48-12=36$

### 法2：最后插C

AB、D、E的排列方案数为 $A_{3}^3=6$ 。然后在AB、D、E排列的基础上插入C。共有4个空，与AB相邻的空有2个。分类讨论：A在B左边，则C不能在AB左侧的空；A在B右边，则C不能在AB右侧的空。

综上，C能插的空总是4-1=3个。故答案为 $A_{2}^2*A_{3}^3*3=36$ 。最后插AB整体的分类讨论和法2类似，不妨归为同一种做法

---

## T4续

### 法3：同时考虑插入AB和C

D、E排列方案数为2，形成3个空。

1. AB和C占两个空，方案数 $A_{3}^2 = 6$ ，乘AB内部方案数2，总方案数12
2. AB和C占同一个空，则和法1类似，形成ABC小团体，但变成B必须在中间。有3个空，总方案数 $2*3=6$

综上，总方案数 $2*(12+6) = 36$

---

## T5：3盆同样的红花和4盆同样的黄花摆成一排，要求红花互不相邻，求方案数

插空法。同样有两种方法。

### 法1：先排黄花

排黄花的方案数为1。黄花形成了5个空位，相当于在5个空位里选3个放红花。总方案数 $1*C_{5}^3 = 10$

### 法2：先排红花

排红花的方案数为1。红花形成了4个空位，设每个空位放的黄花数为 $x_{1},\ \dots,\ x_{4}$ ，则要求的是 $x_{1}+\dots+x_{4}=4,\ x_{1},x_{4} \geq 0,\ x_{2},x_{3} \geq 1$ 的解数。对 $x_{2},\ x_{3}$ 各减1，则所求为 $\sum_{i=1}^{4} x_{i} = 2,\ x_{i} \in N$ 的解数，套隔板法的公式 $C_{2+4-1}^{2} = 10$

---

## T6：小区内有8个相邻车位，有4辆车随机进车位，求恰好没有连续空位的停车方式种数

插空法。同样有两种方法。

### 法1：先排空位

下面我们称4个空位为4个苹果。4个苹果形成5个空位，设各插入 $x_{1},\ \dots,\ x_{5}$ 辆车，要求4个苹果不相邻，即求 $x_{1}+\dots+x_{5}=4,\ x_{2},\dots,x_{4} \geq 1,\ x_{1},x_{5} \geq 0$ 的解数。减去3以后，套隔板法的公式 $C_{1+5-1}^1 = 5$ 。考虑车的全排列后，总方案数 $5 * 4! = 120$

### 法2：先排汽车

4辆车形成5个空位，我们要选4个空位来放4个苹果，方案数 $C_{5}^4 = 5$ 。考虑车的全排列后，总方案数 $5 * 4! = 120$

---

## T7：单位工会组织拔河比赛，每支参赛队都由3名男职工和3名女职工组成。要求3名男职工的站位不能全部连在一起，则每支队伍有几种不同的站位方式？

考试时只推荐法1，但思考法2和法3对掌握插空法和隔板法是大有好处的。

### 法1：正难则反

无任何限制的方案数 $6! = 720$ 。男职工必须绑在一起，则内部方案数 $3! = 6$ ，和女职工一起排的方案数 $4! = 24$ 。总方案数 $720 - 6*24 = 576$

### 法2：先排女职工

女职工排列方案数 $3! = 6$ ，她们形成了4个空位。设每个空位有 $x_{i}\ (i=1,\dots,4)$ 名男性，则男性只有一个限制：不能全聚在同一个空位。这里仍然可以**正难则反**。没有其他限制时，方案数套隔板法的公式 $C_{3+4-1}^3 = 20$ 。全在同一个空位的方案数为4。相减得16

最后考虑男职工内部全排列有 $3! = 6$ 种方案。总方案数 $6*(20-4)*6 = 576$

---
layout: two-cols
---

## T7续

<style>
.slidev-layout.two-columns {
  gap: 1rem;
}
</style>

### 法3：先排男职工

同法2，设男职工形成的4个空位有 $x_{i}\ (i=1,\dots,4)$ 名女性，则限制为： $x_{2}+x_{3} \geq 1$ 。这里仍然考虑**正难则反**。

- 没有其他限制的情形，方案数同法2，20
- $x_{2}+x_{3}=0$ 的情形，要求的是 $x_{1}+x_{4}=3,\ x_{1},x_{4} \in N$ 的方案数，套隔板法公式 $C_{3+2-1}^3 = 4$ 。相减得16

同法2，要考虑女职工全排列的6种方案，后续计算同法2。

::right::

```js {*}{maxHeight:'472px'}
// 给通义千问的提示词：“大佬，有3男（编号1~3）3女（编号4~6）排成一排，请帮我写JS代码算3个男的不全部挨在一起的方案数。算法：dfs”
function countPermutationsWhereNotAllBoysTogether() {
  const boys = new Set([1, 2, 3]);
  const people = [1, 2, 3, 4, 5, 6];
  const n = people.length;
  let totalValid = 0;

  function hasThreeBoysTogether(perm) {
    for (let i = 0; i <= perm.length - 3; i++) {
      if (boys.has(perm[i]) && boys.has(perm[i + 1]) && boys.has(perm[i + 2])) {
        return true;
      }
    }
    return false;
  }

  function dfs(currentPerm, used) {
    if (currentPerm.length === n) {
      if (!hasThreeBoysTogether(currentPerm)) {
        totalValid++;
      }
      return;
    }

    for (let i = 0; i < n; i++) {
      if (!used[i]) {
        used[i] = true;
        currentPerm.push(people[i]);
        dfs(currentPerm, used);
        currentPerm.pop();
        used[i] = false;
      }
    }
  }

  dfs([], Array(n).fill(false));
  return totalValid;
}

const result = countPermutationsWhereNotAllBoysTogether();
console.log(`3个男生不全部挨在一起的方案数为: ${result}`); // 576
```

---
layout: center
class: text-center
---

# 后记

<span class="text-orange font-bold">为做题人的精神自留地添砖加瓦</span>

<span class="text-pink font-bold border border-pink px-2 py-1 rounded-lg">喜欢本期视频的话，别忘了一键三连喔</span>

谢谢观看~
