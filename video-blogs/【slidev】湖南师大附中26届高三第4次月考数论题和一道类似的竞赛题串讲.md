---
theme: dracula
mdc: true
transition: slide-left
class: text-center
tags:
  - 欧拉定理
  - 二项式定理
  - 费马小定理
  - 周期数列
---

## 湖南师大附中26届高三第4次月考数论题和一道类似的竞赛题串讲

月考数论题题源： [湖南师大附中26届高三第4次月考第18题第三问](https://www.douyin.com/note/7578539711850054577)

类似的竞赛题题源：《高中数学竞赛培优教程（专题讲座）》第三版P170练习题6.5.15

作者： **hans7**

**我们必须想象，做题人是幸福的**

文字稿传送门：见视频简介

---

## 湖南师大附中26届高三第4次月考第18题第三问

设 $c_{n}=[\frac{3^n}{4}]$ ，其中 $[x]$ 表示不超过x的最大整数。设其前n项和为 $T_{n}$ ，求 $T_{2026}$ 除以16的余数

## 一道类似的竞赛题

试求不大于100且使 $13 \mid (4^n+3^n+6)$ 成立的自然数n之和

<div class="h-50 flex justify-center items-center text-4xl text-orange">

一顿泡面的功夫，掌握数论中处理 $a^n\ mod\ m$ 的技术
</div>

---

## 前置芝士

不在高考考纲里，但其实非常容易掌握！ [欧拉函数、欧拉定理简介传送门](https://zhuanlan.zhihu.com/p/595583371)

1. 同余的性质见[我往期视频](https://www.bilibili.com/video/BV1Lp4Dz9Epv/)
2. **费马小定理**： $a^{p-1} \equiv 1\ (mod\ p)$
3. **欧拉函数**：设x为正整数，则设 $\phi(x)$ 为不大于x的正整数中与x互素的数的个数
4. **欧拉定理**：如果 $gcd(n,\ m)=1$ ，那么 $a^{\phi(n)} \equiv 1\ (mod\ m)$ 。不难发现费马小定理是欧拉定理的特殊情况
5. 本期视频不直接使用欧拉定理，而是使用欧拉定理揭示的事实： $a^n\ mod\ m$ 是具有周期性的，而且很多数学题会特意让这个周期很小，方便手算求解

---

## 不大于100且使 $13 \mid (4^n+3^n+6)$ 成立的自然数n之和

我们知道13是质数，所以由费马小定理， $3^{12} \equiv 1\ (mod\ 13),\ 4^{12} \equiv 1\ (mod\ 13)$ 。也就是说， $3^{n}$ 和 $4^{n}$ 模13都是**周期数列**，且周期只能是12的因数。那么 $4^n+3^n+6$ 也是周期数列。

设 $3^n,\ 4^n$ 模13的周期分别是 $t_{1},\ t_{2}$ ，那么 $4^n+3^n+6$ 模13的周期就是 $lcm(t_{1},\ t_{2})$

我们算出， $3^n,\ 4^n,\ 4^n+3^n+6$ 模13的数列分别如下：

|             | 1     | 2   | 3   | 4     | 5   | 6   | 7     | 8   | 9   | 10    | 11  | 12  | 13    |
| ----------- | ----- | --- | --- | ----- | --- | --- | ----- | --- | --- | ----- | --- | --- | ----- |
| $3^n$       | **3** | 9   | 1   | **3** | 9   | 1   | **3** | 9   | 1   | **3** | 9   | 1   | **3** |
| $4^n$       | **4** | 3   | 12  | 9     | 10  | 1   | **4** | 3   | 12  | 9     | 10  | 1   | **4** |
| $4^n+3^n+6$ | **0** | 5   | 6   | 5     | 12  | 8   | **0** | 5   | 6   | 5     | 12  | 8   | **0** |

1. 加粗的数据标识周期的开始
2. $4^n,\ 3^n$ 模13的周期分别是 $6,\ 3$ ，所以 $4^n+3^n+6$ 模13的周期就是 $lcm(6,\ 3)=6$

---

## 一道类似的竞赛题题解（续）

由表可知，只有n模6余1时， $4^n+3^n+6$ 才是13的倍数，所以满足题干条件的n有1、7、13、…、97。所求为

$$
\sum_{k=0}^{16} 6k+1=(\sum_{k=0}^{16} 1)+6(\sum_{k=0}^{16} k)=17+6\frac{(0+16)*17}{2}=833
$$

总结：

1. 很多题目会特意让 $a^n\ mod\ m\ (gcd(n,\ m)=1)$ 的周期很小。思考：为什么出题不选 $2^n$ 而选 $4^n$ ？
2. 虽说是竞赛题，但其实它比很多高中数学中档题简单太多~

---

## 设 $c_{n}=[\frac{3^n}{4}]$ ，其中 $[x]$ 表示不超过x的最大整数。设其前n项和为 $T_{n}$ ，求 $T_{2026}$ 除以16的余数

我们遇到的第一个困难：**如何拆掉高斯函数**。如果 $3^n$ 是4的倍数，直接扔掉就好了。但它显然不是，所以我们需要探究它模4究竟余几。假如我们知道它模4余r，那么就可以化简成 $[\frac{3^n}{4}]=\frac{3^n-r}{4}$ 。显然，3和 $3-4=-1$ 模4同余，所以

$$
\boxed{
3^n \equiv (-1)^n\ (mod\ 4)
}
$$

所以当n是奇数， $3^n$ 模4为3，当n是偶数， $3^n$ 模4余1。PS：参考答案为了避免超纲，是用二项式定理展开来说明这一点的~

所以 $T_{2026}$ 可以写成

$$
\textcolor{orange}{
\boldsymbol{
\sum_{n=1}^{2026} [\frac{3^n}{4}]=\sum_{k=1}^{1013} \frac{3^{2k-1}-3}{4}+\frac{3^{2k}-1}{4}=-1013+\sum_{k=1}^{1013} \frac{3^{2k-1}+3^{2k}}{4}
}
}
$$

这里要不要直接把3的幂合并为**等比数列求和**来算呢？其实都可以，只要能顺利把分母去掉就行。

---

## 法1：直接用等比数列求和合并，并使用二项式定理


$$
\boxed{
\sum_{k=1}^{1013} \frac{3^{2k-1}+3^{2k}}{4}=\frac{1}{4}\sum_{k=1}^{2026} 3^k=\frac{3^{2027}-3}{8}
}
$$

除以8，再模16，不好处理。我们要想办法去掉分母的8。小学奥数数论有一个很常用的技巧：对幂进行合并，比如 $3^{2026}=9^{1013}$ 。所以 $\frac{3^{2027}-3}{8}=\frac{3(9^{1013}-1)}{8}$ 。9=8+1，直接**二项式定理**展开： $(8+1)^{1013} \equiv \sum_{i=0}^{1013} C_{1013}^i 1^{1013-i} 8^i$ 。

所以

$$
\textcolor{orange}{
\boldsymbol{
\frac{3^{2027}-3}{8}=\frac{3(C_{1013}^1 8+C_{1013}^2 8^2+\dots+C_{1013}^{1013} 8^{1013})}{8}=3(C_{1013}^1+C_{1013}^2 8^1+\dots+C_{1013}^{1013} 8^{1012})
}
}
$$

8的幂大于等于2时都是16的倍数，都对取模没有影响，所以

$$
T_{2026}\equiv-1013+\frac{3^{2027}-3}{8}\equiv-1013+3(C_{1013}^1+C_{1013}^2 8)\ (mod\ 16)
$$

注意到 $8C_{1013}^2=8*1013*506$ 是16的倍数，所以所求为 $T_{2026} \equiv (3-1)*1013 \equiv 10\ (mod\ 16)$

---

## 法2：先行把4约掉，再看幂取模的周期性

$$
\boxed{
\sum_{k=1}^{1013} \frac{3^{2k-1}+3^{2k}}{4}=\sum_{k=1}^{1013} \frac{3^{2k-1}(1+3)}{4}=\sum_{k=1}^{1013} 3^{2k-1}
}
$$

这里我们不套等比数列求和公式，而是直接开始算取模的周期性。可选操作：为了计算方便，提一个3出来，写成9的幂求和： $\sum_{k=1}^{1013} 3^{2k-1}=3\sum_{k=0}^{1012} 9^k$

回顾前置芝士“4”，9的幂模16的数列周期一定是 $\phi(16)=8$ 的因数。所以我们可以轻松把这个**周期数列**写出来： $9,\ 1,\ 9,\ 1,\ \dots$ 。我们发现周期为2。所以

$$
\textcolor{orange}{
\boldsymbol{
3\sum_{k=0}^{1012} 9^k \equiv 3(1+9+1+9+\dots+1) \equiv 3(1*507+9*506)\ (mod\ 16)
}
}
$$

答案就是

$$
-1013+3(1*507+9*506) \equiv 2*507+10*506 \equiv 2*11+10*10 \equiv 10\ (mod\ 16)
$$

---

## 湖南师大附中26届高三第4次月考第18题第三问总结

处理 $a^n\ mod\ m$ 的技术：

1. 小学奥数数论常用技巧：对幂进行**合并**，比如 $3^{114514}=9^{57257}$
2. 考虑**二项式定理**展开，把大于等于m的底数转化为小于m的底数
3. 考虑 $a^n\ mod\ m$ 随n变化构成的**周期数列**

扩展：扩展欧拉定理、次数、原根、离散对数…

---
layout: center
class: text-center
---

# 后记

<span class="text-orange font-bold">为做题人的精神自留地添砖加瓦</span>

<span class="text-pink font-bold border border-pink px-2 py-1 rounded-lg">喜欢本期视频的话，别忘了一键三连喔</span>

谢谢观看~
