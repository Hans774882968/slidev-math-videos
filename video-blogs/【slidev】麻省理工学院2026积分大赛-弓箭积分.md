---
theme: dracula
mdc: true
transition: slide-left
tags:
  - 单调有界准则
  - 拉格朗日中值定理
  - 数学归纳法
---

<SlidevPageRedirector />
<MovingWatermark />
<!-- <AutoSlide :timeList="[0, 0]" /> -->



---

$$
\int_{\int_{\int_{\int_{0}^{1} x^m dx}^{1} x^m dx}^{1} x^m dx}^{\int_{0}^{\int_{0}^{\int_{0}^{1} x^m dx} x^m dx} x^m dx} x^m dx
$$

1. **数学建模思维**：积分上限和下限各抽象出一个**递推数列** $U(m,n),\ L(m,n)$
2. 写代码算出n阶弓箭积分，写代码画出递推数列的蛛网图…
3. 扩展：被积函数都改为 $x^m$
4. 深入研究 $L(m,n)$ ：数学归纳法、单调有界准则、拉格朗日中值定理、数值分析的**不动点迭代**……

<div class="p-5 flex flex-col justify-center items-center gap-5 text-7xl text-orange">
<div>
看似积分，实则数列极限
</div>
<div>
还串起这么多知识点~
</div>
</div>

---

## 按部就班求解是免不了的~

1. 分别算出积分上限和下限
2. 代入原函数 $\frac{x^2}{2}$

### 积分下限

定义： $L(n)=\frac{1-L^{2}(n-1)}{2},\ L(1)=\int_{0}^{1} x dx=\frac{1}{2},\ n \geq 1$

所求为 $L(3)$ 。 $L(2)=\frac{1-L^2(1)}{2}=\frac{3}{8},\ L(3)=\frac{1-L^2(2)}{2}=\frac{55}{128}$

### 积分上限

定义： $U(n)=\frac{U^2(n-1)}{2},\ U(1)=\int_{0}^{1} x dx=\frac{1}{2},\ n \geq 1$

所求为 $U(3)$ 。 $U(2)=\frac{U^2(1)}{2}=\frac{1}{8},\ U(3)=\frac{U^2(2)}{2}=\frac{1}{128}$

### 答案

$\frac{1}{2}((\frac{1}{128})^2-(\frac{55}{128})^2)=-\frac{54*56}{2^{15}}=-\frac{27*7}{2^{11}}=-\frac{189}{2048}$

---

## 扩展：写代码求出n阶弓箭积分

大佬，你是一名专家Python工程师，精通高质量Pythonic代码编写。图中的积分我们叫它3阶弓箭积分。请帮我写一段Python代码计算n阶弓箭积分。注意：

1. 对x的定积分不需要调用任何计算包，可以直接写出表达式
2. 使用迭代来算，不需要用递归来算
3. 需要算出有理数解

你先帮我看看是否需要使用sage，或者问我其它一些模糊点，我确认后再开始开发

---

根据LLM的回复：

大佬，我们定义1阶弓箭积分：

$$
\int_{\int_{0}^{1} x dx}^{\int_{0}^{1} x dx} x dx
$$

2阶弓箭积分：

$$
\int_{\int_{\int_{0}^{1} x dx}^{1} x dx}^{\int_{0}^{\int_{0}^{1} x dx} x dx} x dx
$$

以此类推。另外，用Python自带的`Fraction`类就行

---

```python {*}{maxHeight:'500px'}
from fractions import Fraction


def arrow_integral(n: int):
    '''
    计算 n 阶弓箭积分 I_n = ∫_{L_n}^{U_n} x dx，
    其中：
        L_1 = U_1 = ∫₀¹ x dx = 1/2
        L_k = ∫_{L_{k-1}}^1 x dx = (1 - L_{k-1}^{2}) / 2
        U_k = ∫_0^{U_{k-1}} x dx = (U_{k-1}^{2}) / 2
        I_n = (U_n^{2} - L_n^{2}) / 2

    参数:
        n (int): 阶数，n >= 1

    返回:
        Fraction: 有理数结果
    '''
    if n < 1:
        raise ValueError('n must be >= 1')

    L = Fraction(1, 2)
    U = Fraction(1, 2)
    res_list = []
    for i in range(1, n + 1):
        res = (U ** 2 - L ** 2) / 2
        res_list.append((L, U, res))
        if i == n:
            break
        L = (Fraction(1) - L ** 2) / 2
        U = (U ** 2) / 2
    return res_list


if __name__ == '__main__':
    n = 8
    res_list = arrow_integral(n)
    for i, (L, U, res) in enumerate(res_list, start=1):
        print(f'I_{i} = {res} = {float(res):.8f}, L_{i} = {L} = {float(L):.8f}, U_{i} = {U} = {float(U):.8f}')
```

---

```python {*}{maxHeight:'500px'}
from fractions import Fraction


def arrow_integral(n: int, m: int = 1):
    '''
    计算 n 阶弓箭积分 I_n = ∫_{L_n}^{U_n} x^m dx，
    其中：
        L_1 = U_1 = ∫₀¹ x^m dx = 1/(m+1)
        L_k = ∫_{L_{k-1}}^1 x^m dx = (1 - L_{k-1}^{m+1}) / (m+1)
        U_k = ∫_0^{U_{k-1}} x dx = (U_{k-1}^{m+1}) / (m+1)
        I_n = (U_n^{m+1} - L_n^{m+1}) / (m+1)

    参数:
        n (int): 阶数，n >= 1
        m (int): 被积函数的阶数，m >= 1

    返回:
        Fraction: 有理数结果
    '''
    if n < 1:
        raise ValueError('n must be >= 1')
    if m < 1:
        raise ValueError('m must be >= 1')

    M = m + 1
    L = Fraction(1, M)
    U = Fraction(1, M)
    res_list = []
    for i in range(1, n + 1):
        res = (U ** M - L ** M) / M
        res_list.append((L, U, res))
        if i == n:
            break
        L = (Fraction(1) - L ** M) / M
        U = (U ** M) / M
    return res_list


if __name__ == '__main__':
    n = 8
    res_list = arrow_integral(n)
    for i, (L, U, res) in enumerate(res_list, start=1):
        print(f'I_{i} = {res} = {float(res):.8f}, L_{i} = {L} = {float(L):.8f}, U_{i} = {U} = {float(U):.8f}')
    n = 6
    res_list = arrow_integral(n, 2)
    for i, (L, U, res) in enumerate(res_list, start=1):
        print(f'I_{i} = {res} = {float(res):.8f}, L_{i} = {L} = {float(L):.8f}, U_{i} = {U} = {float(U):.8f}')
```

---

大佬，我写完了支持被积函数是`x^m`的代码。请帮我检查代码是否有问题，然后帮我算一下`m=2`的情况的 $L_{n}$ 的不动点

大佬，我发现被积函数是 $x^m$ 时，不动点方程是 $x^{m+1}+(m+1)x-1=0$ ，于是`m=1`： $\sqrt{ 2 }-1$ ，`m=2`： $\sqrt[3]{\frac{1 + \sqrt{5}}{2}} + \sqrt[3]{\frac{1 - \sqrt{5}}{2}}$ 。请问对于一般的m，是否都能求出根式解？还是说m=4就没法求根式解了？如果能求，就帮我求出它

---
 
扩展定义： $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\int_{0}^{1} x^m dx=\frac{1}{m+1},\ m,n \geq 1$

---

## 研究数列 $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\frac{1}{m+1},\ m,n \geq 1$

设递推式对应函数 $g(x)=\frac{1-x^{m+1}}{m+1},\ x \in [0,1]$ ，则由刚刚展示的图可知（懒得写严谨证明了），g有唯一**不动点**。不动点定义： $x^*=g(x^*)$ ，它有一个很好的性质： $x^*=g(x^*)=g(g(x^*))=\dots$

由刚刚展示的图可知（为了书写方便，约定下面的 $x_{n}$ 和 $L(m,n)$ 是同义词）：

1. $x_{1}=\frac{1}{m+1}>x^*,\ x_{2}=g(x_{1})<x^*$
2. 如果数列某一项小于 $x^*$ ，则下一项大于 $x^*$ ；如果大于，则下一项小于
3. $0 < L(m,n) \leq \frac{1}{m+1}$ 恒成立
4. 数列的极限存在且为 $x^*$
5. 子列 $\{x_{2n}\}$ 单增，子列 $\{x_{2n-1}\}$ 单减，且极限都为 $x^*$

### 证明1和2

求导： $g'(x)=-x^m\leq0$ ，所以g单减。 $x_{1}=g(0)$ ，而 $x^* > 0$ ，所以 $x_{1}=g(0)>g(x^*)=x^*$ 。设 $x_{n} > x^*$ ，则由g单减： $x_{n+1}=g(x_{n})<g(x^*)=x^*$ 。 $x_{n} < x^*$ 的情况同理。1和2证毕

---

## 证明 $0 < L(m,n) \leq \frac{1}{m+1}$

**数学归纳法**： $0<L(m,1)=\frac{1}{m+1} \leq \frac{1}{m+1}$ 。假设 $L(m,n)$ 成立，则由它大于0得 $L(m,n+1)=\frac{1-L^{m+1}(m,n)}{m+1} < \frac{1}{m+1}$ ，由它小于1得 $L(m,n+1)=\frac{1-L^{m+1}(m,n)}{m+1} > 0$ 。证毕。

注：这几条全部证完自然知道有更强的结论 $L(m,2) \leq L(m,n) \leq \frac{1}{m+1}$

## 证明4和5

思路：分别证明（1）子列 $\{x_{2n}\}$ 单增，子列 $\{x_{2n-1}\}$ 单减。（2） $x^*$ 是 $\{x_{2n}\}$ 的上界，也是 $\{x_{2n-1}\}$ 的下界。于是由**单调有界准则**，性质4和5同时证毕。

### 证明 $\{x_{2n}\}$ 单增， $\{x_{2n-1}\}$ 单减，且极限都为不动点 $x^*$

由性质2， $x_{1},x_{3},x_{5},\dots$ 即 $\{x_{2n-1}\}$ 都大于不动点， $x_{2},x_{4},x_{6},\dots$ 即 $\{x_{2n}\}$ 都小于不动点。“（2） $x^*$ 是 $\{x_{2n}\}$ 的上界，也是 $\{x_{2n-1}\}$ 的下界”证毕。

考虑这两个子数列的相邻两项，比如 $x_{2n+2}$ 和 $x_{2n}$ ，则有 $x_{2n+2}=g(g(x_{2n}))$ 。我们选择做差 $x_{2n+2}-x_{2n}$ 来讨论单调性，因此只需要研究 $h(x)=g(g(x))-x$ 和0的大小关系。

---

## 证明 $\{x_{2n}\}$ 单增， $\{x_{2n-1}\}$ 单减，且极限都为不动点 $x^*$ （续）

求导： $(g(g(x))-x)'=g'(g(x))g'(x)-1$ 。而前面已经有 $g'(x)=-x^m$ ，所以 $(g(g(x)))'=-(g(x))^m*(-x^m)=x^m(g(x))^m$ 。前面已经用数学归纳法证明 $[0,1]$ 上 $g(x) \leq \frac{1}{m+1}$ ，于是

$$
\textcolor{orange}{
\boldsymbol{
(g(g(x))-x)' = x^m(g(x))^m-1 \leq x^m(\frac{1}{m+1})^m - 1 \leq (\frac{1}{m+1})^m - 1 < 0
}
}
$$

所以 $h(x)$ 在 $[0,1]$ 上单减。又由不动点 $x^*=g(x^*)$ 知 $h(x^*)=0$ ：

1. 子列 $\{x_{2n-1}\}$ 的首项 $x_{1}$ 大于不动点，于是由h单减： $h(x_{1})=x_{3}-x_{1} < h(x^*) = 0 \implies x_{3} < x_{1}$
2. 子列 $\{x_{2n}\}$ 的首项 $x_{2}$ 小于不动点，于是由h单减： $h(x_{2})=x_{4}-x_{2} > h(x^*) = 0 \implies x_{4} > x_{2}$

把 $x_{3},\ x_{4}$ 也代入h，结合 $\{x_{2n-1}\}$ 都大于不动点， $\{x_{2n}\}$ 都小于不动点，就能证明 $x_{5}<x_{3},\ x_{6}>x_{4}$ 。这个过程可以无限重复，证毕。严谨的写法是**数学归纳法**，~~这里空白太小写不下~~（too lazy）

---

## 引入新视角：不动点迭代

为了求解方程 $x^{m+1}+(m+1)x-1=0$ 在 $[0,1]$ 上的唯一实根 $x^*$ ，使用**不动点迭代**（Fixed-Point Iteration，FPI） $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\frac{1}{m+1},\ m,n \geq 1$ 。设**迭代函数** $g(x)=\frac{1-x^{m+1}}{m+1},\ 0 \leq x \leq 1$

---

## 学习不动点迭代的提示词

大佬，你是一名数学科研工作者，精通数值分析。我们现在研究数列 $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\int_{0}^{1} x^m dx=\frac{1}{m+1},\ m,n \geq 1$ 。请问它是 $x^{m+1}+(m+1)x-1=0$ 的不动点迭代方程吗？如果是，请判断它是否收敛，然后求出这个迭代的收敛速度。

我是一名高中生，所以希望你的讲解足够详细、通俗易懂！

谢谢大佬！接下来请证明这个数列恒大于0，且 $\{x_{2n}\}$ 单增， $\{x_{2n-1}\}$ 单减。我是一名高中生，所以希望你的讲解足够详细、通俗易懂！

大佬，你是一名数学科研工作者，精通数值分析。请证明不动点迭代中的这个定理：假设函数g是连续可微函数， $g(r)=r$ ， $S = |g'(r)| < 1$ ，则不动点迭代对于一个足够接近r的**初始估计**，以速度S**线性收敛**到不动点r。

我是一名高中生，自学过一点点微积分，请用严谨且通俗易懂的语言向我讲解。

---

## 不动点迭代 $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\frac{1}{m+1},\ m,n \geq 1$ 的收敛条件和收敛速度

如果不动点迭代收敛，则“螺旋状接近”方程的解。否则“螺旋状离开”方程的解。这种图叫不动点迭代的cobweb图（**蛛网图**）

不动点迭代不总是收敛的。《数值分析第2版》定理1.6：假设函数g是连续可微函数， $g(r)=r$ ， $S = |g'(r)| < 1$ ，则不动点迭代对于一个足够接近r的**初始估计** $x_{1}$ ，以速度S**线性收敛**到不动点r（附录1再给出证明）。

**线性收敛**（《数值分析第2版》P32定义1.5）：令 $e_{i}$ 为迭代过程中第i步的**误差**（本期视频的例子是 $|L(m,i)-x^*|$ ），若 $\lim_{ i \to \infty } \frac{e_{i+1}}{e_{i}} = S < 1$ ，我们就说这个迭代是线性收敛的，收敛速度为S。

套用该定理：该迭代线性收敛，速度 $S=|g'(x^*)|=(x^*)^{m}$ 。比如 $m=1$ 时对应方程 $x^2+2x-1=0$ ， $S = \sqrt{ 2 }-1$ ； $m=2$ 时对应方程 $x^3+3x-1=0$ ， $S=(\sqrt[3]{\frac{1 + \sqrt{5}}{2}} + \sqrt[3]{\frac{1 - \sqrt{5}}{2}})^2$

---

## 附录1：《数值分析第2版》定理1.6：证明不动点迭代线性收敛的条件

证明：函数g连续可微， $g(r)=r$ ， $S = |g'(r)| < 1$ ，则不动点迭代对于一个足够接近r的**初始估计** $x_{1}$ ，以速度S**线性收敛**到不动点r，即 $\lim_{ i \to \infty } \frac{e_{i+1}}{e_{i}} = \lim_{ i \to \infty } \frac{|x_{i+1}-r|}{|x_{i}-r|} = S < 1$ 。

我们知道 $x_{i+1}=g(x_{i}),\ r=g(r)$ ，所以 $\lim_{ i \to \infty } \frac{|x_{i+1}-r|}{|x_{i}-r|}=\lim_{ i \to \infty } \frac{|g(x_{i})-g(r)|}{|x_{i}-r|}$ 。这个形式让你想到了什么？**拉格朗日中值定理**！于是存在 $c_{i} \in (min(x_{i},r),\ max(x_{i},r))$ 使得 $g'(c_{i})*(x_{i}-r)=g(x_{i})-g(r) \implies |g'(c_{i})|*|e_{i}|=|e_{i+1}|$ （记为1式）。接下来只需证 $\lim_{ i \to \infty } |g'(c_{i})| = S$ ，即 $c_{i} \to r$ 。

欲证 $c_{i} \to r$ ，只需证 $x_{i} \to r$ 。但这不容易，因为它依赖于g的**全局性质**。所以我们考虑只在**r的附近**让 $|g'(x)| < 1$ 恒成立。但这仍不容易，所以考虑引入中间变量q，让 $|g'(x)|<q<1$ 在r的附近恒成立。

初步看q的范围： $S = |g'(r)| \implies S < q < 1$

---

## 附录1：《数值分析第2版》定理1.6证明（续）

g连续可微，即 $g'(x)$ 连续。所以考虑**函数连续的 $\varepsilon-\delta$ 语言定义**：对任意 $\varepsilon > 0$ ，存在 $\delta > 0$ ，使得当 $|x - r| < \delta$ 时都有：

$$
|g'(x) - g'(r)| < \varepsilon \quad \Rightarrow \quad |g'(x)| < |g'(r)| + \varepsilon = S + \varepsilon \quad (2)
$$

选哪个 $\varepsilon$ 呢？通过q来确定 $\varepsilon$ 。注意到 $S<\frac{1+S}{2}<1$ ，所以一个OK的选择是 $q=\frac{1+S}{2}$ ，于是取 $\varepsilon = q-S = \frac{1-S}{2} > 0$ 。对于此时找到的 $\delta$ ，我们就说 $(r-\delta, r+\delta)$ 为**安全区**。只要迭代点都在安全区里，每次迭代误差就至少缩小为原来的q倍，证明也就完成了。

让**初始估计** $x_{1} \in (r-\delta, r+\delta)$ ，下面用**数学归纳法**证明所有 $x_{i}$ 都在安全区里。 $k=1$ 被我们指定为成立。假设 $x_{k}$ 在安全区里，则由拉格朗日中值定理， $c_{k} \in (min(x_{k},r),\ max(x_{k},r)) \subset (r-\delta, r+\delta)$ ，代入2式得 $|g'(c_{k})| < q$ 。所以 $|e_{k+1}|=|g'(c_{k})|*|e_{k}| < q*|e_{k}| < q*\delta < \delta$ ，证毕。

由上面的放缩式子，我们有 $|e_{k+1}|<q*|e_{k}|<q^2*|e_{k-1}|<\dots<q^k|e_{1}|$ ，这说明误差指数衰减，所以 $\lim_{ k \to \infty } x_{k}=r$ 。证毕。

注：直接用数学归纳法证明 $|e_{k+1}|<q^k|e_{1}|$ ，证明过程会更简短，但没那么方便理解。

---

## 附录2：绘制数列迭代图像的提示词

大佬，请帮我写一个Python函数。输入n和m，绘制曲线 $x^{m+1}+(m+1)x-1=0$ ，以及前n个点：定义数列 $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\frac{1}{m+1},\ m,n \geq 1$ 。

大佬，请在我给你的代码的基础上做以下改动：

1. 把x_min改成 $x^{m+1}+(m+1)x-1=0$ 在0到1的唯一实根，于是plt.axhline这一行可以删掉
2. 图表的文字全部使用中文，注意写代码让matplotlib支持显示中文

请遵循最小改动原则，不修改与本次需求无关的代码

大佬，请在我给你的代码的基础上做以下改动：

1. 用6种不同的颜色循环标识数列构成的点，即数列第i项的颜色是`color_list[(i - 1) % 6]`。并选择第7种颜色来标出方程的唯一实根

请遵循最小改动原则，不修改与本次需求无关的代码

---

## 附录3：绘制不动点迭代的cobweb图

大佬，请帮我写一个Python函数。输入n和m，绘制 $y=x$ 和 $g(x)=\frac{1-x^{m+1}}{m+1}$ ，以及前n个点：定义数列 $L(m,n)=\frac{1-L^{m+1}(m,n-1)}{m+1},\ L(m,1)=\frac{1}{m+1},\ m,n \geq 1$ 。然后用直线连接 $(L(m,n),L(m,n))$ 和 $(L(m,n),L(m,n+1))$ ，用直线连接 $(L(m,n),L(m,n+1))$ 和 $(L(m,n+1),L(m,n+1))$ ，以构成蛛网图

大佬，请在我给你的代码的基础上做以下改动：

1. x左右边界分别改为`x_vals[1], x_vals[0]`
2. 用6种不同的颜色循环标识数列构成的点，即数列第i项的颜色是`color_list[(i - 1) % 6]`。并选择第7种颜色来标出方程 $x=g(x)$ 的唯一实根

请遵循最小改动原则，不修改与本次需求无关的代码

---
layout: center
class: text-center
---

# 后记

<span class="text-orange font-bold">为做题人的精神自留地添砖加瓦</span>

<span class="text-pink font-bold border border-pink px-2 py-1 rounded-lg">喜欢本期视频的话，别忘了点赞、收藏、关注喔</span>

谢谢观看~
